---
# Duo Configuration
# duomfa_duo_config:
#   - option: groups
#     value: "!adm,!root,!sysadmin,!wheel,*"
#   - option: host
#     value: Your API hostname i.e. api-XXXXXXXX.duosecurity.com
#   - option: ikey
#     value: Your integration key
#   - option: skey
#     value: Your secret key

# Required packages
duomfa_packages:
  - libpam-duo

# lineinfile to add pam_duo.so to /etc/pam.d/common-auth
duomfa_pam_common_auth:
  - line: "auth    [success=ok default=bad]    pam_duo.so"
    regexp: "^.*pam_duo.so$"
    insertafter: "# and here are more per-package modules .*$"
# Required pam_ssh_user_auth.so when using pam_2fa
#  - line: "auth    [success=2 ignore=ignore default=die]    pam_ssh_user_auth.so debug"
#    regexp: "^.*pam_ssh_user_auth.*"
#    insertafter: "# and here are more per-package modules .*$"

# Options for OpenSSH
duomfa_sshd_config:
  - option: AuthenticationMethods
    value: "publickey,keyboard-interactive keyboard-interactive"
  - option: KbdInteractiveAuthentication
    value: "yes"
  - option: PasswordAuthentication
    value: "no"
  - option: PubkeyAuthentication
    value: "yes"
  - option: UseDNS
    value: "no"
  - option: UsePAM
    value: "yes"
#  - option: ExposeAuthInfo  # Required when using pam_2fa
#    value: "yes"
